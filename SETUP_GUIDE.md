# ğŸš€ Transparent Search - ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ï¼†å®Ÿè¡Œã‚¬ã‚¤ãƒ‰

## ğŸ“Š ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ–ãƒ©ã‚¦ã‚¶              â”‚
â”‚   (localhost:8081)              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
               â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Express.js Proxy Server                    â”‚
â”‚  (frontend/server.js, port 8081)            â”‚
â”‚  - React ãƒ“ãƒ«ãƒ‰ãƒ•ã‚¡ã‚¤ãƒ«ã‚’é…ä¿¡             â”‚
â”‚  - /api/* ã‚’ /health ã‚’å†…éƒ¨ãƒ—ãƒ­ã‚­ã‚·       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
               â”‚ /api ãƒ—ãƒ­ã‚­ã‚·
               â”‚
               â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  FastAPI Backend                            â”‚
â”‚  (main.py, port 8080)                       â”‚
â”‚  - æ¤œç´¢API                                 â”‚
â”‚  - Swagger UI (/api/docs)                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
         â”Œâ”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”
         â”‚            â”‚
         â–¼            â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ PostgreSQL  Redis  â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ“¦ è¦ä»¶

- Python 3.10+
- Node.js 18+
- Docker & Docker Compose
- PostgreSQL 16
- Redis 7

## ğŸ—ï¸ ãƒ­ãƒ¼ã‚«ãƒ«é–‹ç™ºç’°å¢ƒ

### 1ï¸âƒ£ ãƒªãƒã‚¸ãƒˆãƒªã‚’ã‚¯ãƒ­ãƒ¼ãƒ³

```bash
git clone https://github.com/yunfie-twitter/transparent-search.git
cd transparent-search
```

### 2ï¸âƒ£ ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ï¼ˆFastAPIï¼‰ã®ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—

```bash
# Python ä»®æƒ³ç’°å¢ƒã‚’ä½œæˆ
python3 -m venv venv
source venv/bin/activate  # Windows: venv\Scripts\activate

# ä¾å­˜é–¢ä¿‚ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
pip install -r requirements.txt

# ç’°å¢ƒå¤‰æ•°ã‚’è¨­å®š
cp .env.example .env
# .env ã‚’ç·¨é›†ã—ã¦ã€DATABASE_URL ã¨ REDIS_URL ã‚’è¨­å®š

# ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚’ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—
psql -U search_user -d transparent_search -f schema.sql

# ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã‚’èµ·å‹•
python main.py
# ã¾ãŸã¯: uvicorn main:app --reload --host 0.0.0.0 --port 8080
```

**ç¢ºèªæ–¹æ³•ï¼š**
```bash
curl http://localhost:8080/health
# çµæœ: {"status": "healthy", ...}
```

### 3ï¸âƒ£ ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ï¼ˆReactï¼‰ã®ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—

```bash
cd frontend

# Node ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
npm install

# ç’°å¢ƒå¤‰æ•°ã‚’è¨­å®š
cp .env.example .env
# ã¾ãŸã¯ .env ã‚’ä½œæˆ:
# PORT=8081
# BACKEND_URL=http://localhost:8080
# REACT_APP_API_BASE_URL=http://localhost:8081/api

# React ã‚’ãƒ“ãƒ«ãƒ‰
npm run build

# Express ã‚µãƒ¼ãƒãƒ¼ã‚’èµ·å‹•
npm start
# ã¾ãŸã¯é–‹ç™ºãƒ¢ãƒ¼ãƒ‰: npm run dev (åˆ¥ã‚¿ãƒ¼ãƒŸãƒŠãƒ«ã§ npm run build --watch)
```

**ç¢ºèªæ–¹æ³•ï¼š**
```bash
curl http://localhost:8081/
# çµæœ: HTML ãƒ¬ã‚¹ãƒãƒ³ã‚¹
```

### 4ï¸âƒ£ ãƒ–ãƒ©ã‚¦ã‚¶ã§ã‚¢ã‚¯ã‚»ã‚¹

```
http://localhost:8081
```

---

## ğŸ³ Docker Compose ã§å®Ÿè¡Œï¼ˆæ¨å¥¨ï¼‰

### 1ï¸âƒ£ Docker Compose ã‚’èµ·å‹•

```bash
docker-compose up -d
```

### 2ï¸âƒ£ ã‚µãƒ¼ãƒ“ã‚¹ã®çŠ¶æ…‹ç¢ºèª

```bash
docker-compose ps
```

**æœŸå¾…ã•ã‚Œã‚‹å‡ºåŠ›ï¼š**
```
NAME                               STATUS
transparent-search-postgres        Up (healthy)
transparent-search-redis           Up (healthy)
transparent-search-backend         Up
transparent-search-frontend        Up
```

### 3ï¸âƒ£ ã‚¢ã‚¯ã‚»ã‚¹

| ã‚µãƒ¼ãƒ“ã‚¹ | URL | èª¬æ˜ |
|---------|-----|------|
| **ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰** | http://localhost:8081 | React æ¤œç´¢UI |
| **API ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ** | http://localhost:8081/api/docs | Swagger UI (ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰çµŒç”±) |
| **ãƒ˜ãƒ«ã‚¹ãƒã‚§ãƒƒã‚¯** | http://localhost:8081/health | ã‚µãƒ¼ãƒ“ã‚¹çŠ¶æ…‹ç¢ºèª |
| **PostgreSQL** | localhost:5432 | `psql -U search_user -h localhost -d transparent_search` |
| **Redis** | localhost:6379 | `redis-cli` |

### 4ï¸âƒ£ ãƒ­ã‚°ã‚’ç¢ºèª

```bash
# ã™ã¹ã¦ã®ã‚µãƒ¼ãƒ“ã‚¹ã®ãƒ­ã‚°
docker-compose logs -f

# ç‰¹å®šã®ã‚µãƒ¼ãƒ“ã‚¹ã®ã¿
docker-compose logs -f backend
docker-compose logs -f frontend
```

### 5ï¸âƒ£ ã‚µãƒ¼ãƒ“ã‚¹ã‚’åœæ­¢

```bash
docker-compose down

# ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ï¼ˆPostgreSQLï¼‰ã‚’ã‚¯ãƒªã‚¢ã™ã‚‹å ´åˆ
docker-compose down -v
```

---

## ğŸ”Œ é€šä¿¡ãƒ•ãƒ­ãƒ¼

### æ¤œç´¢ãƒªã‚¯ã‚¨ã‚¹ãƒˆ

```
1. ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒæ¤œç´¢ãƒœãƒƒã‚¯ã‚¹ã§ã€ŒPythonã€ã‚’å…¥åŠ›
   â†“
2. React ã® SearchBox ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆãŒ
   fetch('/api/search?q=Python') ã‚’å®Ÿè¡Œ
   â†“
3. Express ã‚µãƒ¼ãƒãƒ¼ (localhost:8081) ãŒå—ã‘å–ã‚‹
   â†“
4. http-proxy-middleware ãŒ
   http://localhost:8080/api/search?q=Python ã¸ãƒ—ãƒ­ã‚­ã‚·
   â†“
5. FastAPI ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ãŒå‡¦ç†
   - PostgreSQL ã‚’æ¤œç´¢
   - Redis ã«ã‚­ãƒ£ãƒƒã‚·ãƒ¥
   â†“
6. JSON ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã‚’è¿”ã™
   {
     "data": [...],
     "meta": { "count": 100, "took_ms": 45 }
   }
   â†“
7. Express ãŒãã®ã¾ã¾ãƒ–ãƒ©ã‚¦ã‚¶ã«è¿”ã™
   â†“
8. React ãŒ ResultsList ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã«è¡¨ç¤º
```

---

## ğŸ”§ ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°

### âŒ "Connection refused" ã‚¨ãƒ©ãƒ¼

```bash
# ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ãŒèµ·å‹•ã—ã¦ã„ã‚‹ã‹ç¢ºèª
curl http://localhost:8080/health

# ãƒãƒ¼ãƒˆãŒæ—¢ã«ä½¿ç”¨ã•ã‚Œã¦ã„ãªã„ã‹ç¢ºèª
lsof -i :8080
lsof -i :8081
```

### âŒ PostgreSQL ã¸ã®æ¥ç¶šã‚¨ãƒ©ãƒ¼

```bash
# PostgreSQL ãŒèµ·å‹•ã—ã¦ã„ã‚‹ã‹ç¢ºèª
psql -U search_user -h localhost -d transparent_search -c "SELECT 1;"

# æ¥ç¶šæ–‡å­—åˆ—ã‚’ç¢ºèª
# .env ã® DATABASE_URL ãŒæ­£ã—ã„ã‹ç¢ºèª
```

### âŒ React ãƒ“ãƒ«ãƒ‰ãŒå¤±æ•—ã™ã‚‹

```bash
cd frontend

# ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚’ã‚¯ãƒªã‚¢
rm -rf node_modules package-lock.json
npm install
npm run build
```

### âŒ Express ã‚µãƒ¼ãƒãƒ¼ãŒèµ·å‹•ã—ãªã„

```bash
cd frontend

# ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ URL ã‚’ç¢ºèª
echo $BACKEND_URL

# ãƒãƒ¼ãƒˆ 8081 ãŒæ—¢ã«ä½¿ç”¨ã•ã‚Œã¦ã„ãªã„ã‹ç¢ºèª
lsof -i :8081

# ãƒãƒ¼ãƒˆã‚’å¤‰æ›´ã—ã¦èµ·å‹•
PORT=3000 npm start
```

---

## ğŸ“ ä¸»è¦ãªãƒ•ã‚¡ã‚¤ãƒ«æ§‹æˆ

```
transparent-search/
â”œâ”€â”€ main.py                       # FastAPI ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰
â”œâ”€â”€ requirements.txt              # Python ä¾å­˜é–¢ä¿‚
â”œâ”€â”€ docker-compose.yml            # Docker Compose è¨­å®š
â”œâ”€â”€ Dockerfile.backend            # ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ Docker ã‚¤ãƒ¡ãƒ¼ã‚¸
â”‚
â”œâ”€â”€ frontend/                     # React ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰
â”‚   â”œâ”€â”€ server.js                # Express ãƒ—ãƒ­ã‚­ã‚·ã‚µãƒ¼ãƒãƒ¼
â”‚   â”œâ”€â”€ package.json              # Node.js ä¾å­˜é–¢ä¿‚
â”‚   â”œâ”€â”€ Dockerfile                # ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ Docker ã‚¤ãƒ¡ãƒ¼ã‚¸
â”‚   â”œâ”€â”€ public/
â”‚   â”‚   â””â”€â”€ index.html            # HTML ã‚¨ãƒ³ãƒˆãƒªãƒ¼ãƒã‚¤ãƒ³ãƒˆ
â”‚   â””â”€â”€ src/
â”‚       â”œâ”€â”€ index.js              # React ã‚¨ãƒ³ãƒˆãƒªãƒ¼ãƒã‚¤ãƒ³ãƒˆ
â”‚       â”œâ”€â”€ App.js                # ãƒ¡ã‚¤ãƒ³ã‚¢ãƒ—ãƒªã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ
â”‚       â”œâ”€â”€ App.css               # ã‚°ãƒ­ãƒ¼ãƒãƒ«ã‚¹ã‚¿ã‚¤ãƒ«
â”‚       â””â”€â”€ components/
â”‚           â”œâ”€â”€ SearchBox.js      # æ¤œç´¢ãƒœãƒƒã‚¯ã‚¹
â”‚           â”œâ”€â”€ ResultsList.js    # æ¤œç´¢çµæœãƒªã‚¹ãƒˆ
â”‚           â”œâ”€â”€ Pagination.js     # ãƒšãƒ¼ã‚¸ãƒãƒ¼ã‚·ãƒ§ãƒ³
â”‚           â”œâ”€â”€ LoadingSpinner.js # ãƒ­ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°è¡¨ç¤º
â”‚           â””â”€â”€ ErrorMessage.js   # ã‚¨ãƒ©ãƒ¼è¡¨ç¤º
â”‚
â”œâ”€â”€ app/                          # ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«
â”‚   â”œâ”€â”€ core/
â”‚   â”‚   â”œâ”€â”€ database.py           # DB æ¥ç¶š
â”‚   â”‚   â””â”€â”€ cache.py              # Redis ã‚­ãƒ£ãƒƒã‚·ãƒ¥
â”‚   â”œâ”€â”€ api/
â”‚   â”‚   â””â”€â”€ __init__.py           # API ãƒ«ãƒ¼ã‚¿ãƒ¼
â”‚   â”œâ”€â”€ services/
â”‚   â”œâ”€â”€ db/
â”‚   â””â”€â”€ static/                   # é™çš„ãƒ•ã‚¡ã‚¤ãƒ«ï¼ˆéæ¨å¥¨ï¼‰
â”‚
â””â”€â”€ README_FRONTEND.md            # ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰è©³ç´°ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ
```

---

## ğŸ“š API ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ

### æ¤œç´¢

```bash
GET /api/search?q=keyword&limit=10&offset=0

# ä¾‹
curl "http://localhost:8081/api/search?q=Python&limit=10&offset=0"
```

### API ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ

```
http://localhost:8081/api/docs    # Swagger UI
http://localhost:8081/api/redoc   # ReDoc UI
```

### ãƒ˜ãƒ«ã‚¹ãƒã‚§ãƒƒã‚¯

```bash
GET /health

curl http://localhost:8081/health
```

---

## ğŸ” ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£è€ƒæ…®äº‹é …

âœ… **å®Ÿè£…æ¸ˆã¿**
- CORS ãƒ˜ãƒƒãƒ€ãƒ¼è¨­å®š
- å…¥åŠ›å€¤ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³
- ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°
- ãƒ­ã‚°å‡ºåŠ›

âš ï¸ **æœ¬ç•ªç’°å¢ƒã§ã®æ¨å¥¨è¨­å®š**
- CORS ã‚’ç‰¹å®šã®ãƒ‰ãƒ¡ã‚¤ãƒ³ã®ã¿ã«åˆ¶é™
- HTTPS/SSL ã‚’æœ‰åŠ¹åŒ–
- ç’°å¢ƒå¤‰æ•°ã§ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã‚’ç®¡ç†
- WAFï¼ˆWeb Application Firewallï¼‰ã‚’ä½¿ç”¨
- ãƒ¬ãƒ¼ãƒˆåˆ¶é™ã‚’å®Ÿè£…

---

## ğŸ§ª ãƒ†ã‚¹ãƒˆå®Ÿè¡Œ

```bash
# ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ãƒ†ã‚¹ãƒˆ
pytest app/tests/

# ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ãƒ†ã‚¹ãƒˆ
cd frontend
npm test
```

---

## ğŸ“– è©³ç´°ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ

- **ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰**: `README_FRONTEND.md`
- **ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰**: `app/core/README.md`ï¼ˆå­˜åœ¨ã™ã‚‹å ´åˆï¼‰

---

## ğŸ‰ å®Œäº†ï¼

âœ¨ ã“ã‚Œã§ Transparent Search ãŒå®Œå…¨ã«ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ã•ã‚Œã¾ã—ãŸï¼

**æ¬¡ã®ã‚¹ãƒ†ãƒƒãƒ—ï¼š**
1. http://localhost:8081 ã§ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚’è©¦ã™
2. API ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆï¼ˆ/api/docsï¼‰ã‚’ç¢ºèª
3. ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚ºãŒå¿…è¦ãªå ´åˆã¯å„ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ç·¨é›†
4. æœ¬ç•ªç’°å¢ƒã¸ã®ãƒ‡ãƒ—ãƒ­ã‚¤ã‚’æ¤œè¨

---

## ğŸ’¬ ã‚µãƒãƒ¼ãƒˆ

å•é¡ŒãŒç™ºç”Ÿã—ãŸå ´åˆã¯ã€ä»¥ä¸‹ã‚’ã”ç¢ºèªãã ã•ã„ï¼š

1. ã™ã¹ã¦ã®ã‚µãƒ¼ãƒ“ã‚¹ãŒèµ·å‹•ã—ã¦ã„ã‚‹ã‹ï¼ˆ`docker-compose ps`ï¼‰
2. ãƒãƒ¼ãƒˆãŒä½¿ç”¨å¯èƒ½ã‹ï¼ˆ`lsof -i :PORT`ï¼‰
3. ç’°å¢ƒå¤‰æ•°ãŒæ­£ã—ã„ã‹ï¼ˆ`.env` ãƒ•ã‚¡ã‚¤ãƒ«ï¼‰
4. ãƒ­ã‚°ã§è©³ç´°ã‚’ç¢ºèªï¼ˆ`docker-compose logs -f`ï¼‰

âœ¨ Happy searching! ğŸ”
